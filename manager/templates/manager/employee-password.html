<style>
  .passwords-container {
    width: 100%;
    /* max-width: 400px; */
    border: 1px solid #ccc;
    background-color: white;
  }

  .toggle-bar {
    width: 100%;
    display: flex;
    justify-content: space-between;
    align-items: center;
    padding: 10px;
    background-color: #ddd;
    border: none;
    cursor: pointer;
    font-size: 16px;
  }

  .content-container {
    padding: 10px;
    border-top: 1px solid #ccc;
  }

  .hidden {
    display: none;
  }

  .form-field-container {
    margin-bottom: 15px;
  }

  .form-label {
    display: block;
    margin-bottom: 5px;
    font-weight: bold;
    font-size: 14px;
  }

  .form-input {
    width: 100%;
    padding: 8px;
    border: 1px solid #aaa;
    box-sizing: border-box;
    /* Important for width calculation */
  }

  .submit-button {
    width: 100%;
    padding: 10px;
    background-color: #5cb85c;
    color: white;
    border: none;
    cursor: pointer;
  }

  .toggle-icon {
    transition: transform 0.2s;
    /* Simple transition for the icon */
  }
</style>

<div class="passwords-container">

  <!-- Toggle Bar/Header -->
  <div id="toggleButton" class="toggle-bar" aria-expanded="false" aria-controls="passwordFields">
    <span>Change Password</span>

    <!-- Icon for collapsed/expanded state -->
    <svg id="toggleIcon" class="toggle-icon" width="16" height="16" viewBox="0 0 24 24" fill="none"
      stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
      <path d="M19 9l-7 7-7-7"></path>
    </svg>
  </div>

  <!-- Collapsible Content Container - Starts hidden -->
  <div id="passwordFields" class="content-container hidden">

    <!-- Old Password Field -->
    <div class="form-field-container">
      <label for="id_old_password" class="form-label">Old Password</label>
      <input type="password" name="old_password" id="id_old_password" class="form-input">
    </div>

    <!-- New Password Field -->
    <div class="form-field-container">
      <label for="id_password_new" class="form-label">New Password</label>
      <input type="password" name="password_new" id="id_password_new" class="form-input">
    </div>

    <!-- New Password Again Field -->
    <div class="form-field-container">
      <label for="id_password_new2" class="form-label">New Password Again</label>
      <input type="password" name="password_new2" id="id_password_new2" class="form-input">
    </div>
  </div>

</div>

<script>
  document.addEventListener('DOMContentLoaded', () => {
    const toggleButton = document.getElementById('toggleButton');
    const fieldsContainer = document.getElementById('passwordFields');
    const toggleIcon = document.getElementById('toggleIcon');

    /**
     * The toggle function handles the visibility of the content 
     * using the simple 'hidden' class.
     */
    function toggleFields() {
      // Toggle the 'hidden' class on the fields container
      const isHidden = fieldsContainer.classList.toggle('hidden');

      // Update ARIA attributes
      toggleButton.setAttribute('aria-expanded', !isHidden);

      // Simple icon rotation
      if (!isHidden) {
        toggleIcon.style.transform = 'rotate(180deg)';
      } else {
        toggleIcon.style.transform = 'rotate(0deg)';
      }
    }

    toggleButton.addEventListener('click', toggleFields);
  });
</script>